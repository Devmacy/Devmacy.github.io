{"title":"Hardware Eraser Support","uid":"4c444fb32f94eb6704b12be2b19ebd15","slug":"Hardware Eraser Support","date":"2023-07-29T10:00:19.264Z","updated":"2023-07-29T10:00:19.376Z","comments":true,"path":"api/articles/Hardware Eraser Support.json","keywords":"Digital Garden","cover":null,"content":"<p>&#x2F;*<br>Adds support for pen inversion, a.k.a. the hardware eraser on the back of your pen.</p>\n<p>Simply use the eraser on a supported pen, and it will erase. Your previous tool will be restored when the eraser leaves the screen.<br>(Tested with a surface pen, but should work with all windows ink devices, and probably others)</p>\n<p><strong>Note:</strong> This script will stay active until the <em>Obsidian</em> window is closed.</p>\n<p>Compatible with my <em>Auto Draw for Pen</em> script</p>\n<pre><code class=\"javascript\">*/\n\n(function() &#123;\n    &#39;use strict&#39;;\n\n    let activated\n    let revert\n    \n    function handlePointer(e) &#123;\n        const activeTool = ea.getExcalidrawAPI().getAppState().activeTool;\n        const isEraser = e.pointerType === &#39;pen&#39; &amp;&amp; e.buttons &amp; 32\n        function setActiveTool(t) &#123;\n            ea.getExcalidrawAPI().setActiveTool(t)\n        &#125;\n        if (!activated &amp;&amp; isEraser) &#123;\n            //Store previous tool\n            const btns = document.querySelectorAll(&#39;.App-toolbar input.ToolIcon_type_radio&#39;)\n            for (const i in btns) &#123;\n                if (btns[i]?.checked) &#123;\n                    revert = btns[i]\n                &#125;\n            &#125;\n            revert = activeTool\n\n            // Activate eraser tool\n            setActiveTool(&#123;type: &quot;eraser&quot;&#125;)\n            activated = true\n\n            // Force Excalidraw to recognize this the same as pen tip\n            // https://github.com/excalidraw/excalidraw/blob/4a9fac2d1e5c4fac334201ef53c6f5d2b5f6f9f5/src/components/App.tsx#L2945-L2951\n            Object.defineProperty(e, &#39;button&#39;, &#123;\n                value: 0,\n                writable: false\n            &#125;);\n        &#125;\n        // Keep on eraser!\n        if (isEraser &amp;&amp; activated) &#123;\n            setActiveTool(&#123;type: &quot;eraser&quot;&#125;)\n        &#125;\n        if (activated &amp;&amp; !isEraser) &#123;\n            // Revert tool on release\n            // revert.click()\n            setActiveTool(revert)\n            activated = false\n            \n            // Force delete &quot;limbo&quot; elements\n            // This doesn&#39;t happen on the web app\n            // It&#39;s a bug caused by switching to eraser during a stroke\n            ea.setView(&quot;active&quot;);\n            var del = []\n            for (const i in ea.getViewElements()) &#123;\n                const element = ea.getViewElements()[i];\n                if (element.opacity === 20) &#123;\n                    del.push(element)\n                &#125;\n            &#125;\n            ea.deleteViewElements(del)\n            setActiveTool(revert)\n        &#125;\n    &#125;\n    \n    window.addEventListener(&#39;pointerdown&#39;, handlePointer, &#123; capture: true &#125;)\n    window.addEventListener(&#39;pointermove&#39;, handlePointer, &#123; capture: true &#125;)\n&#125;)();\n</code></pre>\n","text":"&#x2F;*Adds support for pen inversion, a.k.a. the hardware eraser on the back of your pen. Simply use the eraser on a supported pen, and it ...","link":"","photos":[],"count_time":{"symbolsCount":"2.9k","symbolsTime":"3 mins."},"categories":[],"tags":[{"name":"L2945","slug":"L2945","count":1,"path":"api/tags/L2945.json"}],"toc":"","author":{"name":"Devmacy","slug":"blog-author","avatar":"https://s1.ax1x.com/2023/01/24/pSYhwB4.jpg","link":"/","description":"数字花园","socials":{"github":"https://github.com/Devmacy","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"Invert colors","uid":"516fdfc977076be85ee0c36a27a100d1","slug":"Invert colors","date":"2023-07-29T10:00:19.266Z","updated":"2023-07-29T10:00:19.380Z","comments":true,"path":"api/articles/Invert colors.json","keywords":"Digital Garden","cover":[],"text":"&#x2F;* The script inverts the colors on the canvas including the color palette in Element Properties. */ const defaultColorPalette = &#123;...","link":"","photos":[],"count_time":{"symbolsCount":"3.1k","symbolsTime":"3 mins."},"categories":[],"tags":[],"author":{"name":"Devmacy","slug":"blog-author","avatar":"https://s1.ax1x.com/2023/01/24/pSYhwB4.jpg","link":"/","description":"数字花园","socials":{"github":"https://github.com/Devmacy","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"Grid Selected Images","uid":"324235689ce5c9f4bfe08baf6efd1e65","slug":"Grid Selected Images","date":"2023-07-29T10:00:19.262Z","updated":"2023-07-29T10:00:19.375Z","comments":true,"path":"api/articles/Grid Selected Images.json","keywords":"Digital Garden","cover":[],"text":"&#x2F;* This script arranges selected images into compact grid view, removing gaps in-between, resizing when necessary and breaking into mul...","link":"","photos":[],"count_time":{"symbolsCount":"1.8k","symbolsTime":"2 mins."},"categories":[],"tags":[],"author":{"name":"Devmacy","slug":"blog-author","avatar":"https://s1.ax1x.com/2023/01/24/pSYhwB4.jpg","link":"/","description":"数字花园","socials":{"github":"https://github.com/Devmacy","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}