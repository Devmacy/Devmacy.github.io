{"title":"Set background color of unclosed line object by adding a shadow clone","uid":"83e6e3c9ec496d8b2a732e3ac4601a3c","slug":"Set background color of unclosed line object by adding a shadow clone","date":"2023-07-29T10:00:19.296Z","updated":"2023-07-29T10:00:19.413Z","comments":true,"path":"api/articles/Set background color of unclosed line object by adding a shadow clone.json","keywords":"Digital Garden","cover":[],"content":"<p>&#x2F;*<br><img src=\"https://raw.githubusercontent.com/zsviczian/obsidian-excalidraw-plugin/master/images/scripts-set-background-color-of-unclosed-line.jpg\"></p>\n<p>Use this script to set the background color of unclosed (i.e. open) line, arrow and freedraw objects by creating a clone of the object. The script will set the stroke color of the clone to transparent and will add a straight line to close the object. Use settings to define the default background color, the fill style, and the strokeWidth of the clone. By default the clone will be grouped with the original object, you can disable this also in settings.</p>\n<pre><code class=\"javascript\">*/\n\nif(!ea.verifyMinimumPluginVersion || !ea.verifyMinimumPluginVersion(&quot;1.5.26&quot;)) &#123;\n  new Notice(&quot;This script requires a newer version of Excalidraw. Please install the latest version.&quot;);\n  return;\n&#125;\n\nsettings = ea.getScriptSettings();\n//set default values on first run\nif(!settings[&quot;Background Color&quot;]) &#123;\n  settings = &#123;\n    &quot;Background Color&quot; : &#123;\n      value: &quot;DimGray&quot;,\n      description: &quot;Default background color of the &#39;shadow&#39; object. Any valid html css color value&quot;,\n    &#125;,\n      &quot;Fill Style&quot;: &#123;\n          value: &quot;hachure&quot;,\n            valueset: [&quot;hachure&quot;,&quot;cross-hatch&quot;,&quot;solid&quot;],\n            description: &quot;Default fill style of the &#39;shadow&#39; object.&quot;\n        &#125;,\n      &quot;Inherit fill stroke width&quot;: &#123;\n          value: true,\n            description: &quot;This will impact the densness of the hachure or cross-hatch fill. Use the stroke width of the line object for which the shadow is created. If set to false, the script will use a stroke width of 2.&quot;\n        &#125;,\n        &quot;Group &#39;shadow&#39; with original&quot;: &#123;\n          value: true,\n            description: &quot;If the toggle is on then the shadow object that is created will be grouped with the unclosed original object.&quot;\n        &#125;\n  &#125;;\n  ea.setScriptSettings(settings);\n&#125;\n\nconst inheritStrokeWidth = settings[&quot;Inherit fill stroke width&quot;].value;\nconst backgroundColor = settings[&quot;Background Color&quot;].value;\nconst fillStyle = settings[&quot;Fill Style&quot;].value;\nconst shouldGroup = settings[&quot;Group &#39;shadow&#39; with original&quot;].value;\n\nconst elements = ea.getViewSelectedElements().filter(el=&gt;el.type===&quot;line&quot; || el.type===&quot;freedraw&quot; || el.type===&quot;arrow&quot;);\nif(elements.length === 0) &#123;\n  new Notice(&quot;No line or freedraw object is selected&quot;);\n&#125;\n\nea.copyViewElementsToEAforEditing(elements);\nelementsToMove = [];\n\nelements.forEach((el)=&gt;&#123;\n  const newEl = ea.cloneElement(el);\n  ea.elementsDict[newEl.id] = newEl;\n  newEl.roughness = 1;\n  if(!inheritStrokeWidth) newEl.strokeWidth = 2;\n  newEl.strokeColor = &quot;transparent&quot;;\n  newEl.backgroundColor = backgroundColor;\n  newEl.fillStyle = fillStyle;\n  if (newEl.type === &quot;arrow&quot;) newEl.type = &quot;line&quot;;\n  const i = el.points.length-1;\n  newEl.points.push([ \n  //adding an extra point close to the last point in case distance is long from last point to origin and there is a sharp bend. This will avoid a spike due to a tight curve.\n    el.points[i][0]*0.9,\n    el.points[i][1]*0.9,\n  ]);\n  newEl.points.push([0,0]);\n  if(shouldGroup) ea.addToGroup([el.id,newEl.id]);\n  elementsToMove.push(&#123;fillId: newEl.id, shapeId: el.id&#125;);\n&#125;);\n\nawait ea.addElementsToView(false,false);\nelementsToMove.forEach((x)=&gt;&#123;\n  const viewElements = ea.getViewElements();\n  ea.moveViewElementToZIndex(\n    x.fillId,\n    viewElements.indexOf(viewElements.filter(el=&gt;el.id === x.shapeId)[0])-1\n  )\n&#125;);\n\nea.selectElementsInView(ea.getElements());\n</code></pre>\n","text":"&#x2F;* Use this script to set the background color of unclosed (i.e. open) line, arrow and freedraw objects by creating a clone of the obje...","link":"","photos":[],"count_time":{"symbolsCount":"3.7k","symbolsTime":"3 mins."},"categories":[],"tags":[],"toc":"","author":{"name":"Devmacy","slug":"blog-author","avatar":"https://s1.ax1x.com/2023/01/24/pSYhwB4.jpg","link":"/","description":"数字花园","socials":{"github":"https://github.com/Devmacy","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"Set Dimensions","uid":"1dbc4fb7c1571db30247f5cd85752d10","slug":"Set Dimensions","date":"2023-07-29T10:00:19.298Z","updated":"2023-07-29T10:00:19.414Z","comments":true,"path":"api/articles/Set Dimensions.json","keywords":"Digital Garden","cover":[],"text":"&#x2F;* Download this file and save to your Obsidian Vault including the first line, or open it in “Raw” and copy the entire contents to Obs...","link":"","photos":[],"count_time":{"symbolsCount":"1.1k","symbolsTime":"1 mins."},"categories":[],"tags":[],"author":{"name":"Devmacy","slug":"blog-author","avatar":"https://s1.ax1x.com/2023/01/24/pSYhwB4.jpg","link":"/","description":"数字花园","socials":{"github":"https://github.com/Devmacy","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"Select Elements of Type","uid":"d63d52fab50d4e7787db7464cd2acc66","slug":"Select Elements of Type","date":"2023-07-29T10:00:19.293Z","updated":"2023-07-29T10:00:19.411Z","comments":true,"path":"api/articles/Select Elements of Type.json","keywords":"Digital Garden","cover":[],"text":"&#x2F;*Prompts you with a list of the different element types in the active image. Only elements of the selected type will be selected on th...","link":"","photos":[],"count_time":{"symbolsCount":"2k","symbolsTime":"2 mins."},"categories":[],"tags":[],"author":{"name":"Devmacy","slug":"blog-author","avatar":"https://s1.ax1x.com/2023/01/24/pSYhwB4.jpg","link":"/","description":"数字花园","socials":{"github":"https://github.com/Devmacy","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}