{"title":"Add Link to Existing File and Open","uid":"6c8693e3bb97385ad768b100b787be72","slug":"Add Link to Existing File and Open","date":"2023-07-29T10:00:19.197Z","updated":"2023-07-29T10:00:19.332Z","comments":true,"path":"api/articles/Add Link to Existing File and Open.json","keywords":"Digital Garden","cover":[],"content":"<p>&#x2F;*<br><img src=\"https://raw.githubusercontent.com/zsviczian/obsidian-excalidraw-plugin/master/images/scripts-add-link-and-open.jpg\"></p>\n<p>Prompts for a file from the vault. Adds a link to the selected element pointing to the selected file. You can control in settings to open the file in the current active pane or an adjacent pane.</p>\n<pre><code class=\"javascript\">*/\n\nif(!ea.verifyMinimumPluginVersion || !ea.verifyMinimumPluginVersion(&quot;1.5.21&quot;)) &#123;\n  new Notice(&quot;This script requires a newer version of Excalidraw. Please install the latest version.&quot;);\n  return;\n&#125;\n\nsettings = ea.getScriptSettings();\n\nif(!settings[&quot;Open link in active pane&quot;]) &#123;\n  settings = &#123;\n    &quot;Open link in active pane&quot;: &#123;\n      value: false,\n      description: &quot;Open the link in the current active pane (on) or a new pane (off).&quot;\n    &#125;,\n    ...settings\n  &#125;;\n  ea.setScriptSettings(settings);\n&#125;\n\nconst openInCurrentPane = settings[&quot;Open link in active pane&quot;].value;\n\nelements = ea.getViewSelectedElements();\nif(elements.length === 0) &#123;\n  new Notice(&quot;No selected elements&quot;);\n  return;\n&#125;\n\nconst files = app.vault.getFiles()\nconst filePaths = files.map((f)=&gt;f.path);\nfile = await utils.suggester(filePaths,files,&quot;Select a file&quot;);\n\nif(!file) return;\n\nconst link = `[[$&#123;app.metadataCache.fileToLinktext(file,ea.targetView.file.path,true)&#125;]]`;\n\nea.style.backgroundColor = &quot;transparent&quot;;\nea.style.strokeColor = &quot;rgba(70,130,180,0.05)&quot;\nea.style.strokeWidth = 2;\nea.style.roughness = 0;\n\nif(elements.length===1 &amp;&amp; elements[0].type !== &quot;text&quot;) &#123;\n  ea.copyViewElementsToEAforEditing(elements);\n    ea.getElements()[0].link = link;\n&#125; else &#123;\n  const b = ea.getBoundingBox(elements);\n  const id = ea.addEllipse(b.topX+b.width-5, b.topY, 5, 5);\n  ea.getElement(id).link = link;\n  ea.copyViewElementsToEAforEditing(elements);\n  ea.addToGroup(elements.map((e)=&gt;e.id).concat([id]));\n&#125;\nawait ea.addElementsToView(false,true,true);\nea.selectElementsInView(ea.getElements());\n\nif(openInCurrentPane) &#123;\n    app.workspace.openLinkText(file.path,ea.targetView.file.path,false);\n  return;\n&#125;\nea.openFileInNewOrAdjacentLeaf(file);\n</code></pre>\n","text":"&#x2F;* Prompts for a file from the vault. Adds a link to the selected element pointing to the selected file. You can control in settings to...","link":"","photos":[],"count_time":{"symbolsCount":"2.1k","symbolsTime":"2 mins."},"categories":[],"tags":[],"toc":"","author":{"name":"Devmacy","slug":"blog-author","avatar":"https://s1.ax1x.com/2023/01/24/pSYhwB4.jpg","link":"/","description":"数字花园","socials":{"github":"https://github.com/Devmacy","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"Add Link to New Page and Open","uid":"001fd04c919b8fa23e01b328b79ea28a","slug":"Add Link to New Page and Open","date":"2023-07-29T10:00:19.199Z","updated":"2023-07-29T10:00:19.333Z","comments":true,"path":"api/articles/Add Link to New Page and Open.json","keywords":"Digital Garden","cover":[],"text":"&#x2F;* Prompts for filename. Offers option to create and open a new Markdown or Excalidraw document. Adds link pointing to the new file, to...","link":"","photos":[],"count_time":{"symbolsCount":"3.2k","symbolsTime":"3 mins."},"categories":[],"tags":[],"author":{"name":"Devmacy","slug":"blog-author","avatar":"https://s1.ax1x.com/2023/01/24/pSYhwB4.jpg","link":"/","description":"数字花园","socials":{"github":"https://github.com/Devmacy","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"Add Connector Point","uid":"c8e3fb38b6d2af41db47c72f8a1e7c96","slug":"Add Connector Point","date":"2023-07-29T10:00:19.194Z","updated":"2023-07-29T10:00:19.331Z","comments":true,"path":"api/articles/Add Connector Point.json","keywords":"Digital Garden","cover":[],"text":"&#x2F;* This script will add a small circle to the top left of each text element in the selection and add the text and the “bullet point” in...","link":"","photos":[],"count_time":{"symbolsCount":708,"symbolsTime":"1 mins."},"categories":[],"tags":[],"author":{"name":"Devmacy","slug":"blog-author","avatar":"https://s1.ax1x.com/2023/01/24/pSYhwB4.jpg","link":"/","description":"数字花园","socials":{"github":"https://github.com/Devmacy","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}