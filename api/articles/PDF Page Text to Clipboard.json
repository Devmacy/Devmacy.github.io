{"title":"PDF Page Text to Clipboard","uid":"c8987ed647e3062b499b6ebe7475f48f","slug":"PDF Page Text to Clipboard","date":"2023-07-29T10:00:19.283Z","updated":"2023-07-29T10:00:19.401Z","comments":true,"path":"api/articles/PDF Page Text to Clipboard.json","keywords":"Digital Garden","cover":null,"content":"<p>&#x2F;*<br>Copies the text from the selected PDF page on the Excalidraw canvas to the clipboard.</p>\n<iframe width=\"560\" height=\"315\" src=\"https://www.youtube.com/embed/Kwt_8WdOUT4\" title=\"YouTube video player\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen></iframe>\nLink:: https://youtu.be/Kwt_8WdOUT4\n\n\n<pre><code class=\"js*/\">const el = ea.getViewSelectedElements().filter(el=&gt;el.type===&quot;image&quot;)[0];\nif(!el) &#123;\n  new Notice(&quot;Select a PDF page&quot;);\n  return;\n&#125;\nconst f = ea.getViewFileForImageElement(el);\nif(f.extension.toLowerCase() !== &quot;pdf&quot;) &#123;\n  new Notice(&quot;Select a PDF page&quot;);\n  return;\n&#125;\n\nconst pageNum = parseInt(ea.targetView.excalidrawData.getFile(el.fileId).linkParts.ref.replace(/\\D/g, &quot;&quot;));\nif(isNaN(pageNum)) &#123;\n  new Notice(&quot;Can&#39;t find page number&quot;);\n  return;\n&#125;\n\nconst pdfDoc = await window.pdfjsLib.getDocument(app.vault.getResourcePath(f)).promise;\nconst page = await pdfDoc.getPage(pageNum);\nconst text = await page.getTextContent();\nif(!text) &#123;\n    new Notice(&quot;Could not get text&quot;);\n    return;\n&#125;\npdfDoc.destroy();\nwindow.navigator.clipboard.writeText(\n  text.items.reduce((acc, cur) =&gt; acc + cur.str.replace(/\\x00/ug, &#39;&#39;) + (cur.hasEOL ? &quot;\\n&quot; : &quot;&quot;),&quot;&quot;)\n);\nnew Notice(&quot;Page text is available on the clipboard&quot;);\n</code></pre>\n","text":"&#x2F;*Copies the text from the selected PDF page on the Excalidraw canvas to the clipboard. Link:: https://youtu.be/Kwt_8WdOUT4 const el = ...","link":"","photos":[],"count_time":{"symbolsCount":"1.2k","symbolsTime":"1 mins."},"categories":[],"tags":[],"toc":"","author":{"name":"Devmacy","slug":"blog-author","avatar":"https://s1.ax1x.com/2023/01/24/pSYhwB4.jpg","link":"/","description":"数字花园","socials":{"github":"https://github.com/Devmacy","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"Rename Image","uid":"0979f76108535de26ea84ad0bdc87200","slug":"Rename Image","date":"2023-07-29T10:00:19.285Z","updated":"2023-07-29T10:00:19.405Z","comments":true,"path":"api/articles/Rename Image.json","keywords":"Digital Garden","cover":[],"text":"&#x2F;* Select an image on the canvas and run the script. You will be prompted to provide a new filename &#x2F; filepath. This cuts down the...","link":"","photos":[],"count_time":{"symbolsCount":"1.1k","symbolsTime":"1 mins."},"categories":[],"tags":[],"author":{"name":"Devmacy","slug":"blog-author","avatar":"https://s1.ax1x.com/2023/01/24/pSYhwB4.jpg","link":"/","description":"数字花园","socials":{"github":"https://github.com/Devmacy","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"Palette loader","uid":"0b0066a8613d76f0c8f7aecf59e585d7","slug":"Palette loader","date":"2023-07-29T10:00:19.281Z","updated":"2023-07-29T10:00:19.400Z","comments":true,"path":"api/articles/Palette loader.json","keywords":"Digital Garden","cover":[],"text":"&#x2F;* Link:: https://youtu.be/epYNx2FSf2w Link:: https://youtu.be/diBT5iaoAYo Design your palette at http://paletton.com/Once you are happ...","link":"","photos":[],"count_time":{"symbolsCount":"12k","symbolsTime":"11 mins."},"categories":[],"tags":[],"author":{"name":"Devmacy","slug":"blog-author","avatar":"https://s1.ax1x.com/2023/01/24/pSYhwB4.jpg","link":"/","description":"数字花园","socials":{"github":"https://github.com/Devmacy","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}